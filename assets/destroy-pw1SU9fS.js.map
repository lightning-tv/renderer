{"version":3,"file":"destroy-pw1SU9fS.js","sources":["../../tests/destroy.ts"],"sourcesContent":["/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2023 Comcast Cable Communications Management, LLC.\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { type INode } from '@lightningjs/renderer';\nimport logo from '../assets/lightning.png';\nimport type { ExampleSettings } from '../common/ExampleSettings.js';\n\nexport async function automation(settings: ExampleSettings) {\n  const destroy = await test(settings);\n  await settings.snapshot();\n  destroy(100);\n  await settings.snapshot();\n}\n\nexport default async function test({\n  renderer,\n  testRoot,\n  automation,\n  perfMultiplier,\n}: ExampleSettings) {\n  // create 100 nodes\n  const numOuterNodes = (100 * Math.max(perfMultiplier, 1)) / 2;\n  const nodes: INode[] = [];\n\n  const bg = renderer.createNode({\n    width: 1920,\n    height: 1080,\n    color: 0xff1e293b,\n    parent: testRoot,\n  });\n\n  const gridSize = Math.ceil(Math.sqrt(numOuterNodes));\n  for (let i = 0; i < numOuterNodes; i++) {\n    const baseX = (i % gridSize) * 150;\n    const baseY = Math.floor(i / gridSize) * 60;\n\n    const node = renderer.createNode({\n      width: 125,\n      height: 25,\n      x: baseX,\n      y: baseY,\n      src: logo,\n      shader: renderer.createShader('DynamicShader', {\n        effects: [\n          {\n            type: 'radius',\n            props: {\n              radius: 50,\n            },\n          },\n        ],\n      }),\n      parent: bg,\n    });\n\n    nodes.push(node);\n\n    const textNode = renderer.createTextNode({\n      width: 125,\n      height: 25,\n      x: baseX,\n      y: baseY + 25,\n      text: 'Lightning 3',\n      color: 0xffffffff,\n      parent: bg,\n    });\n\n    nodes.push(textNode);\n  }\n\n  console.log(\n    `Created ${numOuterNodes} texture nodes and ${numOuterNodes} text nodes`,\n  );\n\n  const destroy = (amount = 10) => {\n    const nodesToDestroy = nodes.splice(0, amount);\n    nodesToDestroy.forEach((node) => {\n      node.destroy();\n    });\n\n    console.log(`Destroyed ${amount} nodes, ${nodes.length} remaining`);\n\n    if (nodes.length > 0) {\n      setTimeout(destroy, 100);\n    } else {\n      console.log('All nodes destroyed');\n    }\n  };\n\n  if (!automation) {\n    setTimeout(destroy, 100);\n  }\n\n  return destroy;\n}\n"],"names":["automation","logo"],"mappings":";AAuBA,eAAsB,WAAW,UAA2B;AACpD,QAAA,UAAU,MAAM,KAAK,QAAQ;AACnC,QAAM,SAAS;AACf,UAAQ,GAAG;AACX,QAAM,SAAS;AACjB;AAEA,eAA8B,KAAK;AAAA,EACjC;AAAA,EACA;AAAA,EACA,YAAAA;AAAAA,EACA;AACF,GAAoB;AAElB,QAAM,gBAAiB,MAAM,KAAK,IAAI,gBAAgB,CAAC,IAAK;AAC5D,QAAM,QAAiB,CAAA;AAEjB,QAAA,KAAK,SAAS,WAAW;AAAA,IAC7B,OAAO;AAAA,IACP,QAAQ;AAAA,IACR,OAAO;AAAA,IACP,QAAQ;AAAA,EAAA,CACT;AAED,QAAM,WAAW,KAAK,KAAK,KAAK,KAAK,aAAa,CAAC;AACnD,WAAS,IAAI,GAAG,IAAI,eAAe,KAAK;AAChC,UAAA,QAAS,IAAI,WAAY;AAC/B,UAAM,QAAQ,KAAK,MAAM,IAAI,QAAQ,IAAI;AAEnC,UAAA,OAAO,SAAS,WAAW;AAAA,MAC/B,OAAO;AAAA,MACP,QAAQ;AAAA,MACR,GAAG;AAAA,MACH,GAAG;AAAA,MACH,KAAKC;AAAAA,MACL,QAAQ,SAAS,aAAa,iBAAiB;AAAA,QAC7C,SAAS;AAAA,UACP;AAAA,YACE,MAAM;AAAA,YACN,OAAO;AAAA,cACL,QAAQ;AAAA,YACV;AAAA,UACF;AAAA,QACF;AAAA,MAAA,CACD;AAAA,MACD,QAAQ;AAAA,IAAA,CACT;AAED,UAAM,KAAK,IAAI;AAET,UAAA,WAAW,SAAS,eAAe;AAAA,MACvC,OAAO;AAAA,MACP,QAAQ;AAAA,MACR,GAAG;AAAA,MACH,GAAG,QAAQ;AAAA,MACX,MAAM;AAAA,MACN,OAAO;AAAA,MACP,QAAQ;AAAA,IAAA,CACT;AAED,UAAM,KAAK,QAAQ;AAAA,EACrB;AAEQ,UAAA;AAAA,IACN,WAAW,aAAa,sBAAsB,aAAa;AAAA,EAAA;AAGvD,QAAA,UAAU,CAAC,SAAS,OAAO;AAC/B,UAAM,iBAAiB,MAAM,OAAO,GAAG,MAAM;AAC9B,mBAAA,QAAQ,CAAC,SAAS;AAC/B,WAAK,QAAQ;AAAA,IAAA,CACd;AAED,YAAQ,IAAI,aAAa,MAAM,WAAW,MAAM,MAAM,YAAY;AAE9D,QAAA,MAAM,SAAS,GAAG;AACpB,iBAAW,SAAS,GAAG;AAAA,IAAA,OAClB;AACL,cAAQ,IAAI,qBAAqB;AAAA,IACnC;AAAA,EAAA;AAGF,MAAI,CAACD,aAAY;AACf,eAAW,SAAS,GAAG;AAAA,EACzB;AAEO,SAAA;AACT;"}