{"version":3,"file":"text-align-legacy-DMc39BZh.js","sources":["../../tests/text-align.ts"],"sourcesContent":["/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2024 Comcast Cable Communications Management, LLC.\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ExampleSettings } from '../common/ExampleSettings.js';\nimport { getLoremIpsum } from '../common/LoremIpsum.js';\n\nexport async function automation(settings: ExampleSettings) {\n  const next = await test(settings);\n  await settings.snapshot();\n  while (await next()) {\n    await settings.snapshot();\n  }\n}\n\n/**\n * This test is to ensure that the canvas text renderer and the sdf text\n * renderer both support the `textAlign` property consistently.\n *\n * Two text nodes are created with the same text, font size, and font family.\n * The only difference is that one uses the canvas text renderer (red text) and\n * the other uses the sdf text renderer (blue text). The `textAlign` property\n * is changed during each step.\n *\n * This test includes a single line text case to ensure that the `textAlign`\n * bug reported in https://github.com/lightning-js/renderer/issues/171 works.\n *\n * Unfortunately, the canvas text renderer horitzonal layout will vary between\n * browsers and platforms. There will be some differences in the horizontal\n * text layout between the two text nodes. Don't expect entirely homogeneous\n * purple text.\n *\n * Expected results: The two text nodes align text properly according to the\n * `textAlign` property.\n *\n * Press the right arrow key to cycle through the different `textAlign` values.\n *\n * @param param0\n * @returns\n */\nexport default async function test({ renderer, testRoot }: ExampleSettings) {\n  const fontFamily = 'Ubuntu';\n  const fontSize = 20;\n  const yPos = 0;\n  testRoot.width = 500;\n  testRoot.height = 500;\n  testRoot.clipping = true;\n  testRoot.color = 0xffffffff;\n\n  const canvasText = renderer.createTextNode({\n    y: yPos,\n    width: testRoot.width,\n    fontSize,\n    fontFamily,\n    contain: 'width',\n    color: 0xff0000ff,\n    textRendererOverride: 'canvas',\n    parent: testRoot,\n  });\n  const sdfText = renderer.createTextNode({\n    y: yPos,\n    width: testRoot.width,\n    fontSize,\n    fontFamily,\n    contain: 'width',\n    color: 0x0000ff77,\n    parent: testRoot,\n    zIndex: 3,\n  });\n  const indexInfo = renderer.createTextNode({\n    x: testRoot.width,\n    y: testRoot.height,\n    mount: 1,\n    width: 0,\n    height: 0,\n    color: 0x000000ff,\n    fontFamily: 'Ubuntu',\n    fontSize: 20,\n    text: '1',\n    parent: testRoot,\n  });\n\n  let i = 0;\n  const mutations = [\n    () => {\n      canvasText.text = sdfText.text = getLoremIpsum(1200);\n      canvasText.textAlign = sdfText.textAlign = 'left';\n    },\n    () => {\n      canvasText.textAlign = sdfText.textAlign = 'center';\n    },\n    () => {\n      canvasText.textAlign = sdfText.textAlign = 'right';\n    },\n    () => {\n      canvasText.text = sdfText.text = 'Single Line Text';\n      canvasText.textAlign = sdfText.textAlign = 'left';\n    },\n    () => {\n      canvasText.textAlign = sdfText.textAlign = 'center';\n    },\n    () => {\n      canvasText.textAlign = sdfText.textAlign = 'right';\n    },\n  ];\n\n  /**\n   * Run the next mutation in the list\n   *\n   * @param idx\n   * @returns `false` if loop is set to false and we've already gone through all mutations. Otherwise `true`.\n   */\n  async function next(loop = false, idx = i + 1): Promise<boolean> {\n    if (idx > mutations.length - 1) {\n      if (!loop) {\n        return false;\n      }\n      idx = 0;\n    }\n    i = idx;\n    mutations[i]?.();\n    indexInfo.text = (i + 1).toString();\n    return true;\n  }\n  await next(false, 0);\n\n  window.addEventListener('keydown', (event) => {\n    // When right arrow is pressed, call next\n    if (event.key === 'ArrowRight') {\n      next(true).catch(console.error);\n    }\n  });\n\n  return next;\n}\n"],"names":["automation","settings","__async","_regeneratorRuntime","mark","_callee","next","wrap","_callee$","_context","prev","test","sent","snapshot","stop","_0","arguments","_ref","renderer","testRoot","_callee3","fontFamily","fontSize","yPos","canvasText","sdfText","indexInfo","i","mutations","_callee3$","_context3","_next","loop","length","undefined","idx","_callee2","_a","_callee2$","_context2","abrupt","call","text","toString","width","height","clipping","color","createTextNode","y","contain","textRendererOverride","parent","zIndex","x","mount","getLoremIpsum","textAlign","window","addEventListener","event","key","catch","console","error"],"mappings":"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"}