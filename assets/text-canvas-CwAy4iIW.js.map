{"version":3,"file":"text-canvas-CwAy4iIW.js","sources":["../../tests/text-canvas.ts"],"sourcesContent":["/*\n * If not stated otherwise in this file or this component's LICENSE file the\n * following copyright and licenses apply:\n *\n * Copyright 2024 Comcast Cable Communications Management, LLC.\n *\n * Licensed under the Apache License, Version 2.0 (the License);\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ExampleSettings } from '../common/ExampleSettings.js';\n\nconst Colors = {\n  Black: 0x000000ff,\n  Red: 0xff0000ff,\n  Green: 0x00ff00ff,\n  Blue: 0x0000ffff,\n  Magenta: 0xff00ffff,\n  Gray: 0x7f7f7fff,\n  White: 0xffffffff,\n};\n\nconst randomIntBetween = (from: number, to: number) =>\n  Math.floor(Math.random() * (to - from + 1) + from);\n\n/**\n * Tests that Single-Channel Signed Distance Field (SSDF) fonts are rendered\n * correctly.\n *\n * Text that is thinner than the certified snapshot may indicate that the\n * SSDF font atlas texture was premultiplied before being uploaded to the GPU.\n *\n * @param settings\n * @returns\n */\nexport default async function test(settings: ExampleSettings) {\n  const { renderer, testRoot } = settings;\n\n  // Set a smaller snapshot area\n  // testRoot.width = 200;\n  // testRoot.height = 200;\n  // testRoot.color = 0xffffffff;\n\n  const nodes: any[] = [];\n\n  const renderNode = (t: string) => {\n    const node = renderer.createTextNode({\n      x: Math.random() * 1900,\n      y: Math.random() * 1080,\n      text: 'CANVAS ' + t,\n      fontFamily: 'sans-serif',\n      parent: testRoot,\n      fontSize: 80,\n    });\n\n    nodes.push(node);\n\n    // pick random color from Colors\n    node.color =\n      Object.values(Colors)[\n        randomIntBetween(0, Object.keys(Colors).length - 1)\n      ] || 0xff0000ff;\n  };\n\n  const spawn = (amount = 1) => {\n    for (let i = 0; i < amount; i++) {\n      renderNode(i.toString());\n    }\n  };\n\n  const despawn = (amount = 100) => {\n    for (let i = 0; i < amount; i++) {\n      const node = nodes.pop();\n      node.destroy();\n    }\n  };\n\n  const move = () => {\n    for (let i = 0; i < nodes.length; i++) {\n      const node = nodes[i];\n      node.x = randomIntBetween(0, 1600);\n      node.y = randomIntBetween(0, 880);\n    }\n  };\n\n  const newColor = () => {\n    for (let i = 0; i < nodes.length; i++) {\n      const node = nodes[i];\n      node.color =\n        Object.values(Colors)[\n          randomIntBetween(0, Object.keys(Colors).length - 1)\n        ] || 0x000000ff;\n    }\n  };\n\n  let animating = false;\n  const animate = () => {\n    animating = !animating;\n\n    const animateNode = (node: any) => {\n      nodes.forEach((node) => {\n        node\n          .animate(\n            {\n              x: randomIntBetween(20, 1740),\n              y: randomIntBetween(20, 900),\n              rotation: Math.random() * Math.PI,\n            },\n            {\n              duration: 3000,\n              easing: 'ease-out',\n            },\n          )\n          .start();\n      });\n    };\n\n    const animateRun = () => {\n      if (animating) {\n        for (let i = 0; i < nodes.length; i++) {\n          animateNode(nodes[i]);\n        }\n        setTimeout(animateRun, 3050);\n      }\n    };\n\n    animateRun();\n  };\n\n  window.addEventListener('keydown', (event) => {\n    if (event.key === 'ArrowUp') {\n      spawn();\n    } else if (event.key === 'ArrowDown') {\n      despawn();\n    } else if (event.key === 'ArrowLeft') {\n      move();\n    } else if (event.key === 'ArrowRight') {\n      move();\n    } else if (event.key === '1') {\n      newColor();\n    } else if (event.key === ' ') {\n      animate();\n    }\n  });\n\n  spawn();\n}\n"],"names":["node"],"mappings":"AAqBA,MAAM,SAAS;AAAA,EACb,OAAO;AAAA,EACP,KAAK;AAAA,EACL,OAAO;AAAA,EACP,MAAM;AAAA,EACN,SAAS;AAAA,EACT,MAAM;AAAA,EACN,OAAO;AACT;AAEA,MAAM,mBAAmB,CAAC,MAAc,OACtC,KAAK,MAAM,KAAK,OAAA,KAAY,KAAK,OAAO,KAAK,IAAI;AAYnD,eAA8B,KAAK,UAA2B;AACtD,QAAA,EAAE,UAAU,SAAa,IAAA;AAO/B,QAAM,QAAe,CAAA;AAEf,QAAA,aAAa,CAAC,MAAc;AAC1B,UAAA,OAAO,SAAS,eAAe;AAAA,MACnC,GAAG,KAAK,OAAA,IAAW;AAAA,MACnB,GAAG,KAAK,OAAA,IAAW;AAAA,MACnB,MAAM,YAAY;AAAA,MAClB,YAAY;AAAA,MACZ,QAAQ;AAAA,MACR,UAAU;AAAA,IAAA,CACX;AAED,UAAM,KAAK,IAAI;AAGf,SAAK,QACH,OAAO,OAAO,MAAM,EAClB,iBAAiB,GAAG,OAAO,KAAK,MAAM,EAAE,SAAS,CAAC,CACpD,KAAK;AAAA,EAAA;AAGH,QAAA,QAAQ,CAAC,SAAS,MAAM;AAC5B,aAAS,IAAI,GAAG,IAAI,QAAQ,KAAK;AACpB,iBAAA,EAAE,UAAU;AAAA,IACzB;AAAA,EAAA;AAGI,QAAA,UAAU,CAAC,SAAS,QAAQ;AAChC,aAAS,IAAI,GAAG,IAAI,QAAQ,KAAK;AACzB,YAAA,OAAO,MAAM;AACnB,WAAK,QAAQ;AAAA,IACf;AAAA,EAAA;AAGF,QAAM,OAAO,MAAM;AACjB,aAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;AAC/B,YAAA,OAAO,MAAM,CAAC;AACf,WAAA,IAAI,iBAAiB,GAAG,IAAI;AAC5B,WAAA,IAAI,iBAAiB,GAAG,GAAG;AAAA,IAClC;AAAA,EAAA;AAGF,QAAM,WAAW,MAAM;AACrB,aAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;AAC/B,YAAA,OAAO,MAAM,CAAC;AACpB,WAAK,QACH,OAAO,OAAO,MAAM,EAClB,iBAAiB,GAAG,OAAO,KAAK,MAAM,EAAE,SAAS,CAAC,CACpD,KAAK;AAAA,IACT;AAAA,EAAA;AAGF,MAAI,YAAY;AAChB,QAAM,UAAU,MAAM;AACpB,gBAAY,CAAC;AAEP,UAAA,cAAc,CAAC,SAAc;AAC3B,YAAA,QAAQ,CAACA,UAAS;AACtBA,cACG;AAAA,UACC;AAAA,YACE,GAAG,iBAAiB,IAAI,IAAI;AAAA,YAC5B,GAAG,iBAAiB,IAAI,GAAG;AAAA,YAC3B,UAAU,KAAK,OAAO,IAAI,KAAK;AAAA,UACjC;AAAA,UACA;AAAA,YACE,UAAU;AAAA,YACV,QAAQ;AAAA,UACV;AAAA,UAED,MAAM;AAAA,MAAA,CACV;AAAA,IAAA;AAGH,UAAM,aAAa,MAAM;AACvB,UAAI,WAAW;AACb,iBAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;AACzB,sBAAQ;AAAA,QACtB;AACA,mBAAW,YAAY,IAAI;AAAA,MAC7B;AAAA,IAAA;AAGS;EAAA;AAGN,SAAA,iBAAiB,WAAW,CAAC,UAAU;AACxC,QAAA,MAAM,QAAQ,WAAW;AACrB;IAAA,WACG,MAAM,QAAQ,aAAa;AAC5B;IAAA,WACC,MAAM,QAAQ,aAAa;AAC/B;IAAA,WACI,MAAM,QAAQ,cAAc;AAChC;IAAA,WACI,MAAM,QAAQ,KAAK;AACnB;IAAA,WACA,MAAM,QAAQ,KAAK;AACpB;IACV;AAAA,EAAA,CACD;AAEK;AACR;"}